import cv2
import matplotlib.pyplot as plt
from skimage.segmentation import felzenszwalb, mark_boundaries
from skimage.util import img_as_float

# Load image
img = cv2.imread("person.jpg")
img_rgb = cv2.cvtColor(img, cv2.COLOR_BGR2RGB)

# Convert to float
img_float = img_as_float(img_rgb)

# Felzenszwalb Segmentation
segments = felzenszwalb(img_float, scale=100, sigma=0.5, min_size=100)

# Display results
plt.figure(figsize=(10, 5))

plt.subplot(1, 2, 1)
plt.imshow(img_rgb)
plt.title("Original Image")
plt.axis("off")

plt.subplot(1, 2, 2)
plt.imshow(mark_boundaries(img_rgb, segments))
plt.title("Segmented Image (Felzenszwalb)")
plt.axis("off")

plt.show()

